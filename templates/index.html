{{define "main"}}
<h1>entropy.social</h1>

{{if .User}}
<p>Hello, {{.User.Name}}!
<form method="post" action="/logout">
    {{.CSRFField}}
    <button>Log out</button>
</form>
</p>
{{else}}
<p>Hello, stranger! <a href="/login">Log in</a> <a href="/signup">Sign up</a></p>
{{end}}

{{if .User}}
<form method="post" action="/posts/new">
    {{.CSRFField}}
    <div><label for="content">shout into the void</label></div>
    <div><textarea id="content" name="content" rows="4" cols="60"></textarea></div>
    <div><button>Post!</button></div>
</form>
{{end}}

<ul class="posts">
    {{range .Posts}}
    <li class="post">
        <img class="post__avatar" src="/static/Prospero_and_miranda.jpg">
        <div>
            <div class="post__header">
                <a href="{{.UserURL}}">{{.UserName}}</a>
                <time class="post__time">{{.CreatedAt.Format "Jan 02 2006"}}</time>
            </div>
            <div class="post__content">
                {{.Content}}
            </div>
        </div>
    </li>
    {{end}}
</ul>
{{end}}
